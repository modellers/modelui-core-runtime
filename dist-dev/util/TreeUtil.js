"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../_rollupPluginBabelHelpers-aae655da.js");function n(r){var t=r.targetIndex,o=r.node,d=r.currentIndex,a=r.getNodeKey,i=r.path,l=void 0===i?[]:i,c=r.lowerSiblingCounts,u=void 0===c?[]:c,h=r.ignoreCollapsed,p=void 0===h||h,s=r.isPseudoRoot,x=void 0!==s&&s?[]:[].concat(e._toConsumableArray(l),[a({node:o,treeIndex:d})]);if(d===t)return{node:o,lowerSiblingCounts:u,path:x};if(!o.children||p&&!0!==o.expanded)return{nextIndex:d+1};for(var f=d+1,g=o.children.length,v=0;v<g;v+=1){var b=n({ignoreCollapsed:p,getNodeKey:a,targetIndex:t,node:o.children[v],currentIndex:f,lowerSiblingCounts:[].concat(e._toConsumableArray(u),[g-v-1]),path:x});if(b.node)return b;f=b.nextIndex}return{nextIndex:f}}function r(e){var r=e.node,t=e.ignoreCollapsed;return n({getNodeKey:function(){},ignoreCollapsed:void 0===t||t,node:r,currentIndex:0,targetIndex:-1}).nextIndex-1}function t(n){var r=n.callback,o=n.getNodeKey,d=n.ignoreCollapsed,a=n.isPseudoRoot,i=void 0!==a&&a,l=n.node,c=n.parentNode,u=void 0===c?null:c,h=n.currentIndex,p=n.path,s=void 0===p?[]:p,x=n.lowerSiblingCounts,f=void 0===x?[]:x,g=i?[]:[].concat(e._toConsumableArray(s),[o({node:l,treeIndex:h})]);if(!i&&!1===r(i?null:{node:l,parentNode:u,path:g,lowerSiblingCounts:f,treeIndex:h}))return!1;if(!l.children||!0!==l.expanded&&d&&!i)return h;var v=h,b=l.children.length;if("function"!=typeof l.children)for(var I=0;I<b;I+=1)if(!1===(v=t({callback:r,getNodeKey:o,ignoreCollapsed:d,node:l.children[I],parentNode:i?null:l,currentIndex:v+1,lowerSiblingCounts:[].concat(e._toConsumableArray(f),[b-I-1]),path:g})))return!1;return v}function o(n){var r=n.callback,t=n.getNodeKey,d=n.ignoreCollapsed,a=n.isPseudoRoot,i=void 0!==a&&a,l=n.node,c=n.parentNode,u=void 0===c?null:c,h=n.currentIndex,p=n.path,s=void 0===p?[]:p,x=n.lowerSiblingCounts,f=void 0===x?[]:x,g=e._objectSpread2({},l),v=i?[]:[].concat(e._toConsumableArray(s),[t({node:g,treeIndex:h})]),b={node:g,parentNode:u,path:v,lowerSiblingCounts:f,treeIndex:h};if(!g.children||!0!==g.expanded&&d&&!i)return{treeIndex:h,node:r(b)};var I=h,y=g.children.length;return"function"!=typeof g.children&&(g.children=g.children.map((function(n,a){var l=o({callback:r,getNodeKey:t,ignoreCollapsed:d,node:n,parentNode:i?null:g,currentIndex:I+1,lowerSiblingCounts:[].concat(e._toConsumableArray(f),[y-a-1]),path:v});return I=l.treeIndex,l.node}))),{node:r(b),treeIndex:I}}function d(e){var n=e.treeData,r=e.getNodeKey,o=e.callback,d=e.ignoreCollapsed,a=void 0===d||d;!n||n.length<1||t({callback:o,getNodeKey:r,ignoreCollapsed:a,isPseudoRoot:!0,node:{children:n},currentIndex:-1,path:[],lowerSiblingCounts:[]})}function a(e){var n=e.treeData,r=e.getNodeKey,t=e.callback,d=e.ignoreCollapsed,a=void 0===d||d;return!n||n.length<1?[]:o({callback:t,getNodeKey:r,ignoreCollapsed:a,isPseudoRoot:!0,node:{children:n},currentIndex:-1,path:[],lowerSiblingCounts:[]}).node.children}function i(n){var t=n.treeData,o=n.path,d=n.newNode,a=n.getNodeKey,i=n.ignoreCollapsed,l=void 0===i||i,c="RESULT_MISS",u=function n(t){var i=t.isPseudoRoot,u=void 0!==i&&i,h=t.node,p=t.currentTreeIndex,s=t.pathIndex;if(!u&&a({node:h,treeIndex:p})!==o[s])return c;if(s>=o.length-1)return"function"==typeof d?d({node:h,treeIndex:p}):d;if(!h.children)throw new Error("Path referenced children of node with no children.");for(var x=p+1,f=0;f<h.children.length;f+=1){var g=n({node:h.children[f],currentTreeIndex:x,pathIndex:s+1});if(g!==c)return g?e._objectSpread2(e._objectSpread2({},h),{},{children:[].concat(e._toConsumableArray(h.children.slice(0,f)),[g],e._toConsumableArray(h.children.slice(f+1)))}):e._objectSpread2(e._objectSpread2({},h),{},{children:[].concat(e._toConsumableArray(h.children.slice(0,f)),e._toConsumableArray(h.children.slice(f+1)))});x+=1+r({node:h.children[f],ignoreCollapsed:l})}return c}({node:{children:t},currentTreeIndex:-1,pathIndex:-1,isPseudoRoot:!0});if(u===c)throw new Error("No node found at the given path.");return u.children}function l(n){var t=n.targetDepth,o=n.minimumTreeIndex,d=n.newNode,a=n.ignoreCollapsed,i=n.expandParent,c=n.isPseudoRoot,u=void 0!==c&&c,h=n.isLastChild,p=n.node,s=n.currentIndex,x=n.currentDepth,f=n.getNodeKey,g=n.path,v=void 0===g?[]:g,b=function(n){return u?[]:[].concat(e._toConsumableArray(v),[f({node:n,treeIndex:s})])};if(s>=o-1||h&&(!p.children||!p.children.length)){if("function"==typeof p.children)throw new Error("Cannot add to children defined by a function");var I=i?{expanded:!0}:{},y=e._objectSpread2(e._objectSpread2(e._objectSpread2({},p),I),{},{children:p.children?[d].concat(e._toConsumableArray(p.children)):[d]});return{node:y,nextIndex:s+2,insertedTreeIndex:s+1,parentPath:b(y),parentNode:u?null:y}}if(x>=t-1){if(!p.children||"function"==typeof p.children||!0!==p.expanded&&a&&!u)return{node:p,nextIndex:s+1};for(var C=s+1,N=null,_=null,m=0;m<p.children.length;m+=1){if(C>=o){N=C,_=m;break}C+=1+r({node:p.children[m],ignoreCollapsed:a})}if(null===_){if(C<o&&!h)return{node:p,nextIndex:C};N=C,_=p.children.length}var S=e._objectSpread2(e._objectSpread2({},p),{},{children:[].concat(e._toConsumableArray(p.children.slice(0,_)),[d],e._toConsumableArray(p.children.slice(_)))});return{node:S,nextIndex:C,insertedTreeIndex:N,parentPath:b(S),parentNode:u?null:S}}if(!p.children||"function"==typeof p.children||!0!==p.expanded&&a&&!u)return{node:p,nextIndex:s+1};var D=null,w=null,K=null,A=s+1,P=p.children;"function"!=typeof P&&(P=P.map((function(e,n){if(null!==D)return e;var r=l({targetDepth:t,minimumTreeIndex:o,newNode:d,ignoreCollapsed:a,expandParent:i,isLastChild:h&&n===P.length-1,node:e,currentIndex:A,currentDepth:x+1,getNodeKey:f,path:[]});return"insertedTreeIndex"in r&&(D=r.insertedTreeIndex,K=r.parentNode,w=r.parentPath),A=r.nextIndex,r.node})));var j=e._objectSpread2(e._objectSpread2({},p),{},{children:P}),T={node:j,nextIndex:A};return null!==D&&(T.insertedTreeIndex=D,T.parentPath=[].concat(e._toConsumableArray(b(j)),e._toConsumableArray(w)),T.parentNode=K),T}exports.addNodeUnderParent=function(n){var t=n.treeData,o=n.newNode,d=n.parentKey,i=void 0===d?null:d,l=n.getNodeKey,c=n.ignoreCollapsed,u=void 0===c||c,h=n.expandParent,p=void 0!==h&&h,s=n.addAsFirstChild,x=void 0!==s&&s;if(null===i)return x?{treeData:[o].concat(e._toConsumableArray(t||[])),treeIndex:0}:{treeData:[].concat(e._toConsumableArray(t||[]),[o]),treeIndex:(t||[]).length};var f=null,g=!1,v=a({treeData:t,getNodeKey:l,ignoreCollapsed:u,callback:function(n){var t=n.node,d=n.treeIndex,a=n.path,l=a?a[a.length-1]:null;if(g||l!==i)return t;g=!0;var c=e._objectSpread2({},t);if(p&&(c.expanded=!0),!c.children)return f=d+1,e._objectSpread2(e._objectSpread2({},c),{},{children:[o]});if("function"==typeof c.children)throw new Error("Cannot add to children defined by a function");for(var h=d+1,s=0;s<c.children.length;s+=1)h+=1+r({node:c.children[s],ignoreCollapsed:u});f=h;var v=x?[o].concat(e._toConsumableArray(c.children)):[].concat(e._toConsumableArray(c.children),[o]);return e._objectSpread2(e._objectSpread2({},c),{},{children:v})}});if(!g)throw new Error("No node found with the given key.");return{treeData:v,treeIndex:f}},exports.changeNodeAtPath=i,exports.find=function(n){var r=n.getNodeKey,t=n.treeData,o=n.searchQuery,d=n.searchMethod,a=n.searchFocusOffset,i=n.expandAllMatchPaths,l=void 0!==i&&i,c=n.expandFocusMatchPaths,u=void 0===c||c,h=0,p=function n(t){var i=t.isPseudoRoot,c=void 0!==i&&i,p=t.node,s=t.currentIndex,x=t.path,f=void 0===x?[]:x,g=[],v=!1,b=!1,I=c?[]:[].concat(e._toConsumableArray(f),[r({node:p,treeIndex:s})]),y=c?null:{path:I,treeIndex:s},C=p.children&&"function"!=typeof p.children&&p.children.length>0;!c&&d(e._objectSpread2(e._objectSpread2({},y),{},{node:p,searchQuery:o}))&&(h===a&&(b=!0),h+=1,v=!0);var N=s,_=e._objectSpread2({},p);return C&&(_.children=_.children.map((function(r){var t=n({node:r,currentIndex:N+1,path:I});return t.node.expanded?N=t.treeIndex:N+=1,(t.matches.length>0||t.hasFocusMatch)&&(g=[].concat(e._toConsumableArray(g),e._toConsumableArray(t.matches)),t.hasFocusMatch&&(b=!0),(l&&t.matches.length>0||(l||u)&&t.hasFocusMatch)&&(_.expanded=!0)),t.node}))),c||_.expanded||(g=g.map((function(n){return e._objectSpread2(e._objectSpread2({},n),{},{treeIndex:null})}))),v&&(g=[e._objectSpread2(e._objectSpread2({},y),{},{node:_})].concat(e._toConsumableArray(g))),{node:g.length>0?_:p,matches:g,hasFocusMatch:b,treeIndex:N}}({node:{children:t},isPseudoRoot:!0,currentIndex:-1});return{matches:p.matches,treeData:p.node.children}},exports.getDepth=function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n.children?"function"==typeof n.children?r+1:n.children.reduce((function(n,t){return Math.max(n,e(t,r+1))}),r):r},exports.getDescendantCount=r,exports.getFlatDataFromTree=function(e){var n=e.treeData,r=e.getNodeKey,t=e.ignoreCollapsed,o=void 0===t||t;if(!n||n.length<1)return[];var a=[];return d({treeData:n,getNodeKey:r,ignoreCollapsed:o,callback:function(e){a.push(e)}}),a},exports.getNodeAtPath=function(e){var n=e.treeData,r=e.path,t=e.getNodeKey,o=e.ignoreCollapsed,d=void 0===o||o,a=null;try{i({treeData:n,path:r,getNodeKey:t,ignoreCollapsed:d,newNode:function(e){var n=e.node,r=e.treeIndex;return a={node:n,treeIndex:r},n}})}catch(e){}return a},exports.getTreeFromFlatData=function(n){var r=n.flatData,t=n.getKey,o=void 0===t?function(e){return e.id}:t,d=n.getParentKey,a=void 0===d?function(e){return e.parentId}:d,i=n.rootKey,l=void 0===i?"0":i;if(!r)return[];var c={};if(r.forEach((function(e){var n=a(e);n in c?c[n].push(e):c[n]=[e]})),!(l in c))return[];var u=function n(r){var t=o(r);return t in c?e._objectSpread2(e._objectSpread2({},r),{},{children:c[t].map((function(e){return n(e)}))}):e._objectSpread2({},r)};return c[l].map((function(e){return u(e)}))},exports.getVisibleNodeCount=function(e){var n=e.treeData,r=function e(n){return n.children&&!0===n.expanded&&"function"!=typeof n.children?1+n.children.reduce((function(n,r){return n+e(r)}),0):1};return n.reduce((function(e,n){return e+r(n)}),0)},exports.getVisibleNodeInfoAtIndex=function(e){var r=e.treeData,t=e.index,o=e.getNodeKey;if(!r||r.length<1)return null;var d=n({targetIndex:t,getNodeKey:o,node:{children:r,expanded:!0},currentIndex:-1,path:[],lowerSiblingCounts:[],isPseudoRoot:!0});return d.node?d:null},exports.insertNode=function(n){var r=n.treeData,t=n.depth,o=n.minimumTreeIndex,d=n.newNode,a=n.getNodeKey,i=void 0===a?function(){}:a,c=n.ignoreCollapsed,u=void 0===c||c,h=n.expandParent,p=void 0!==h&&h;if(!r&&0===t)return{treeData:[d],treeIndex:0,path:[i({node:d,treeIndex:0})],parentNode:null};var s=l({targetDepth:t,minimumTreeIndex:o,newNode:d,ignoreCollapsed:u,expandParent:p,getNodeKey:i,isPseudoRoot:!0,isLastChild:!0,node:{children:r},currentIndex:-1,currentDepth:-1});if(!("insertedTreeIndex"in s))throw new Error("No suitable position found to insert.");var x=s.insertedTreeIndex;return{treeData:s.node.children,treeIndex:x,path:[].concat(e._toConsumableArray(s.parentPath),[i({node:d,treeIndex:x})]),parentNode:s.parentNode}},exports.isDescendant=function e(n,r){return!!n.children&&"function"!=typeof n.children&&n.children.some((function(n){return n===r||e(n,r)}))},exports.map=a,exports.removeNode=function(e){var n=e.treeData,r=e.path,t=e.getNodeKey,o=e.ignoreCollapsed,d=null,a=null;return{treeData:i({treeData:n,path:r,getNodeKey:t,ignoreCollapsed:void 0===o||o,newNode:function(e){var n=e.node,r=e.treeIndex;return d=n,a=r,null}}),node:d,treeIndex:a}},exports.removeNodeAtPath=function(e){var n=e.treeData,r=e.path,t=e.getNodeKey,o=e.ignoreCollapsed;return i({treeData:n,path:r,getNodeKey:t,ignoreCollapsed:void 0===o||o,newNode:null})},exports.toggleExpandedForAll=function(n){var r=n.treeData,t=n.expanded,o=void 0===t||t;return a({treeData:r,callback:function(n){var r=n.node;return e._objectSpread2(e._objectSpread2({},r),{},{expanded:o})},getNodeKey:function(e){return e.treeIndex},ignoreCollapsed:!1})},exports.walk=d;
//# sourceMappingURL=TreeUtil.js.map

{"version":3,"file":"InputBase.js","sources":["../../src/event/InputBase.js"],"sourcesContent":["// common tools\nimport StateBase from './StateBase'\nimport StateBaseComponent from './StateBaseComponent'\n// event handler\n// import Event from './Event'\n\nconst events = {\n  changed: {\n    alias: [],\n    info: {\n      name: 'Changed',\n      description: 'Input value changed'\n    },\n    schema: {}\n  },\n  enabled: {\n    alias: [],\n    info: {\n      name: 'Enabled',\n      description: 'Enabled input'\n    },\n    schema: {}\n  },\n  disabled: {\n    alias: [],\n    info: {\n      name: 'Disabled',\n      description: 'Disabled input'\n    },\n    schema: {}\n  },\n  submitted: {\n    alias: [],\n    info: {\n      name: 'Submitted',\n      description: 'Submitted value'\n    },\n    schema: {}\n  },\n  cleared: {\n    alias: [],\n    info: {\n      name: 'Cleared',\n      description: 'Cleared value'\n    },\n    schema: {}\n  },\n  populated: {\n    alias: [],\n    info: {\n      name: 'Populated',\n      description: 'Populated value'\n    },\n    schema: {}\n  },\n  replaced: {\n    alias: [],\n    info: {\n      name: 'Replaced',\n      description: 'Replaced value'\n    },\n    schema: {}\n  },\n  invalidated: {\n    alias: [],\n    info: { name: 'In-validated', description: 'Unselecting item' },\n    schema: {}\n  },\n  validated: {\n    alias: [],\n    info: { name: 'De-Selected', description: 'Unselecting item' },\n    schema: {}\n  }\n}\n\nconst triggers = {\n  submit: {\n    info: { name: 'Submit', description: 'Submits the form data' },\n    schema: {},\n    alias: []\n  },\n  enable: {\n    info: {\n      name: 'Enables',\n      description: 'Enables the form so that we can change form inputs'\n    },\n    schema: {},\n    alias: []\n  },\n  disable: {\n    info: {\n      name: 'Disable',\n      description: 'Disables the form so that we can not change input value'\n    },\n    schema: {},\n    alias: []\n  },\n  // change: { info: { name: 'Change', description: 'Changes' }, schema: {}, alias: [] },\n  clear: {\n    info: {\n      name: 'Clear',\n      description: 'Removes all input values clearing the form'\n    },\n    schema: {},\n    alias: []\n  },\n  populate: {\n    info: {\n      name: 'Populate',\n      description: 'Fills the form with specified data'\n    },\n    schema: {},\n    alias: []\n  },\n  replace: {\n    info: {\n      name: 'Replace',\n      description: 'Replaces the form with specified data'\n    },\n    schema: {},\n    alias: []\n  }\n}\n\nclass StateInput extends StateBase.StateInstance {\n  constructor(props) {\n    super(props)\n    this.props = props\n    // apply initial values\n    this.state = {\n      data: {\n        id: props.data.id || null,\n        value: props.data.value,\n        schema: props.data.schema || props.schema\n      },\n      enabled: (props.config || {}).enabled || true,\n      schema: props.schema\n    }\n\n    if (!this.props.manager) {\n      throw new Error('Manager was not passed through StateInput props')\n    }\n\n    this.eventManager = this.props.manager.getEventManager()\n  }\n\n  registerComponent = (actionHandlers, eventHandlers, component_info) => {\n    const self = this\n    actionHandlers = actionHandlers || {}\n    eventHandlers = eventHandlers || {}\n    // add our known handlers\n    // register componenet overiding or adding new event handlers\n    const dataActionHandlers = {\n      submit: {\n        schema: {},\n        handler: (obj) => {\n          // Event.EventManager.getInstance().addEvent(\n          this.eventManager.addEvent(this.props.id, 'submitting', obj, null)\n          this.getActionState('submit', function (change) {\n            const update = self.alterState(change)\n            // Event.EventManager.getInstance().addEvent(\n            self.eventManager.addEvent(\n              self.props.id,\n              'submitted',\n              update.data,\n              null\n            )\n          })\n        }\n      },\n      enable: {\n        schema: {},\n        handler: (obj) => {\n          const change = { disabled: false }\n          self.alterState(change)\n          if (this.updateView('enable', obj, obj, self.state.data)) {\n            // Event.EventManager.getInstance().addEvent(\n            self.eventManager.addEvent(self.props.id, 'enabled', change, null)\n          }\n        }\n      },\n      disable: {\n        schema: {},\n        handler: (obj) => {\n          const change = { disabled: true }\n          self.alterState(change)\n          if (this.updateView('disable', obj, obj, self.state.data)) {\n            // Event.EventManager.getInstance().addEvent(\n            self.eventManager.addEvent(self.props.id, 'disabled', change, null)\n          }\n        }\n      },\n      clear: {\n        schema: {},\n        handler: (obj) => {\n          const change = { data: { value: '' } } // getSchemaDefaults(this.state.data.schema || this.state.schema);\n          const update = self.alterState(change)\n          // Event.EventManager.getInstance().addEvent(\n          self.eventManager.addEvent(self.props.id, 'clearing', change, {})\n          if (self.updateView('clear', obj, obj, update)) {\n            // Event.EventManager.getInstance().addEvent(\n            self.eventManager.addEvent(\n              self.props.id,\n              'cleared',\n              update.data,\n              null\n            )\n          }\n          // Event.EventManager.getInstance().addEvent(\n          self.eventManager.addEvent(\n            self.props.id,\n            'changed',\n            update.data,\n            null\n          )\n        }\n      },\n      populate: {\n        schema: {},\n        handler: (obj) => {\n          const change = { data: { value: obj.value, id: obj.id } }\n          self.alterState(change)\n          if (self.updateView('populate', obj, obj, self.state.data)) {\n            // Event.EventManager.getInstance().addEvent(\n            self.eventManager.addEvent(self.props.id, 'populated', obj, null)\n          }\n          // Event.EventManager.getInstance().addEvent(\n          self.eventManager.addEvent(self.props.id, 'changed', obj, null)\n        }\n      },\n      replace: {\n        schema: {},\n        handler: (obj) => {\n          const replaced = {\n            ...self.state,\n            data: {\n              ...obj,\n              id: obj.id,\n              value: obj.value || this.state.data.value,\n              schema: obj.schema || this.state.data.schema\n            }\n          }\n          self.setState(replaced)\n          if (self.updateView('replace', obj, obj, self.state.data)) {\n            // Event.EventManager.getInstance().addEvent(\n            self.eventManager.addEvent(self.props.id, 'replaced', obj, null)\n          }\n          // Event.EventManager.getInstance().addEvent(\n          self.eventManager.addEvent(self.props.id, 'changed', obj, null)\n        }\n      }\n    }\n\n    // register componenet overiding or adding new event handlers\n    // this.ddEvent = Event.EventManager.getInstance().register(\n    self.ddEvent = self.eventManager.register(\n      self.props.id,\n      { ...dataActionHandlers, ...actionHandlers },\n      { ...events, ...eventHandlers },\n      component_info\n    )\n    return self.ddEvent\n  }\n}\n\nclass InputBase extends StateBaseComponent.StateBaseComponent {\n  /**\n   * Used to manage internal state of avatars\n   */\n  constructor(props) {\n    if (!props.config.options) {\n      props.config.options = {}\n    }\n    super(props)\n    this.props = props\n  }\n\n  updateView = (action, arr, updated, data) => {\n    // extend by parent\n    return true\n  }\n\n  render() {\n    return null\n  }\n}\n\nexport default { events, triggers, StateInput, InputBase }\n"],"names":["events","changed","alias","info","name","description","schema","enabled","disabled","submitted","cleared","populated","replaced","invalidated","validated","StateInput","_StateBase$StateInsta","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","actionHandlers","eventHandlers","component_info","self","dataActionHandlers","submit","handler","obj","eventManager","addEvent","id","getActionState","change","update","alterState","data","enable","updateView","state","disable","clear","value","populate","replace","_objectSpread","_objectSpread2","setState","ddEvent","register","config","manager","Error","getEventManager","_createClass","StateBase","StateInstance","InputBase","_StateBaseComponent$S","_super2","_this2","options","action","arr","updated","key","StateBaseComponent","InputBase$1","triggers"],"mappings":"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"}
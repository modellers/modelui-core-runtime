import{d as t,b as e,c as n,f as a,g as o}from"../_rollupPluginBabelHelpers-55d249d8.js";import r from"../event/Event.js";var i=function(){function o(){n(this,o),t(this,"_states",{})}return e(o,[{key:"getManager",value:function(t){return this._states[t]}},{key:"clearAll",value:function(){}},{key:"createState",value:function(t){return this.createManager(t.id,t)}},{key:"createStates",value:function(t){var e,n=a(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;this.createManager(o.id,o)}}catch(t){n.e(t)}finally{n.f()}}},{key:"createManager",value:function(t,e){var n=c.getInstance(),a=n.getComponent(e.type);if(a){var o=a.config,r=this.getManager(t);return r||(o.state&&(e.manager||(e.manager=n),(r=this.createStateByClass(o.state,e)).registerComponent&&r.registerComponent({},{},o),this._states[t]=r),r)}throw new Error("Component type does not exist: "+e.type)}},{key:"createStateByClass",value:function(t,e){return t?new t(e):null}},{key:"createLayoutState",value:function(t){var e=this;s(t,(function(t){t.type&&t.id&&t.config&&(t.data||t.content||t.actions)&&e.createState(t)}))}}],[{key:"getInstance",value:function(){return null===o._instance&&(o._instance=new o),this._instance}}]),o}();t(i,"_instance",null);var s=function(t,e){!function t(n){for(var a in n)e&&n[a]&&e(n[a]),n[a].data&&t(n[a].data),n[a].content&&t([n[a].content]),n[a].actions&&t([n[a].actions])}(t)},c=function(){function a(){n(this,a),t(this,"_components",{})}return e(a,[{key:"getEventManager",value:function(){return this._event_manager}},{key:"getStateFactory",value:function(){return this._state_factory}},{key:"getStateManager",value:function(){return this._state_factory}},{key:"clearAll",value:function(){this._components={}}},{key:"registerComponent",value:function(t){t.manager=this,"function"==typeof t.component?this._components[t.type]=t:console.error("Could not register "+t.type+" since it was not a function")}},{key:"getComponentTypes",value:function(){return Object.keys(this._components)}},{key:"getComponents",value:function(){return this._components}},{key:"getComponent",value:function(t){return this._components[t]}},{key:"getComponentInstance",value:function(t,e){e.manager=this;var n=this._components[t];if(n)return n.is_withclass?n.component:new n.component(e);console.warn("Component instance not registered of type: "+t)}},{key:"collectComponentInventory",value:function(){for(var t={},e=0,n=Object.entries(this._components);e<n.length;e++){var a=o(n[e],2),r=a[0],i=a[1],s=i.config;if(s&&r&&s.type){var c="";if(s.relation&&(c=s.relation.within),t[s.type]={id:s.type,title:s.name,type:s.type,events:i.events,actions:i.triggers,category:"TBD",parent:c,schema:s.options},s.contains)for(var u=0,l=Object.entries(s.contains);u<l.length;u++){var f=o(l[u],2),y=f[0],g=f[1],p=s.contains[y];t[y]={id:y,title:p.title||p.id,category:"TBD",type:y,parent:s.type,schema:g}}}}return t}}],[{key:"getInstance",value:function(){return null===a._instance&&(a._instance=new a,a._instance._event_manager=r.EventManager.getInstance(),a._instance._state_factory=i.getInstance()),this._instance}}]),a}();t(c,"_instance",null);var u={ComponentManager:c,StateManager:i};export{u as default,s as walkLayout};
//# sourceMappingURL=Manager.js.map

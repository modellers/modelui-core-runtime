import{MemoryManager as t}from"./MemoryManager.js";import{ObjectCollection as e,config as n,events as o,triggers as a}from"./ObjectCollection.js";import{createComponentClassTests as i,createComponentRegisterTests as s,testEventSequence as c}from"../../util/TestUtil.js";import r from"../../layout/Manager.js";import d from"../Components.js";import l from"../../event/Event.js";import"../../_rollupPluginBabelHelpers-55d249d8.js";import"../../event/ObjectBase.js";import"../../event/StateBase.js";import"../../util/ObjUtil.js";import"react";import"./Data.js";import"./XMLParser.js";import"../../json2xml-ac73b7d0.js";import"../Network/Network.js";import"../Network/RequestObject.js";describe("ObjectCollection protocol",(function(){i(r.ComponentManager.getInstance(),d,null,n,["insert","read","update","upsert","delete"],["invalid","failure","inserting","inserted","reading","read","upserting","upserted","updating","updated","deleting","deleted","missing"],{},void 0,{render:!1}).forEach((function(t){test(t.title,t.test)}))})),describe("ObjectCollection register",(function(){s(r.ComponentManager.getInstance(),d,"object",e,a,o,n,{}).forEach((function(t){test(t.title,t.test)}))})),describe("ObjectCollection memory test",(function(){beforeEach((function(){l.EventManager.getInstance().clearAll(),new e({id:"test_collection",type:"object",schema:{},data:{1:{id:"1",ok:1},"1d":{father:{daugther:8,son:5}}},manager:r.ComponentManager.getInstance()})})),test("Initiated data exists",(function(e){c(r.ComponentManager.getInstance(),"test_collection","read","1","read",(function(n){expect(n.id).toEqual("1"),expect(n.ok).toEqual(1);var o=t.getInstance().getMemory("test_collection").getData();expect(o.docs[1]).toEqual({id:"1",ok:1}),expect(o.docs["1d"]).toEqual({father:{daugther:8,son:5}}),e()}))})),test("Inserting data",(function(e){c(r.ComponentManager.getInstance(),"test_collection","insert",{id:"2",ok:2},"inserted",(function(n){expect(n.id).toEqual("2"),expect(n.ok).toEqual(2);var o=t.getInstance().getMemory("test_collection").getData();expect(o.docs[2]).toEqual({id:"2",ok:2}),e()}))})),test("Updating missing data results in missing",(function(t){c(r.ComponentManager.getInstance(),"test_collection","update",{id:"MISSING-ID",OK:"Ok value 2"},"missing",(function(e){expect(e.id).toEqual("MISSING-ID"),t()}))})),test("Updating shallow object",(function(e){c(r.ComponentManager.getInstance(),"test_collection","update",{id:"1",ok:"FINE"},"updated",(function(n){expect(n).toEqual({id:"1",ok:"FINE"});var o=t.getInstance().getMemory("test_collection").getData();expect(o.docs[1]).toEqual({id:"1",ok:"FINE"}),e()}))})),test("Updating deep object",(function(e){c(r.ComponentManager.getInstance(),"test_collection","update",{id:"1d",father:{daughter:9}},"updated",(function(n){var o=t.getInstance().getMemory("test_collection").getData();expect(o.docs["1d"]).toEqual({father:{daugther:8,son:5,daughter:9},id:"1d"}),e()}))}))}));
//# sourceMappingURL=ObjectCollection.test.js.map

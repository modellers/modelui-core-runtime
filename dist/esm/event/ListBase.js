import{h as e,_ as t,a,b as n,c as d,d as s,e as i,i as r,g as c,j as o}from"../_rollupPluginBabelHelpers-55d249d8.js";import l from"./StateBase.js";import p from"./StateBaseComponent.js";import{findItemIndexById as u,mergeDeep as h,removeItemIndexByIndex as m}from"../util/ObjUtil.js";import"react";var f={$id:"v1/listbase/..",type:"array",items:{$ref:"#/definitions/identifier"},definitions:{identifier:{type:"object",additionalProperties:!0,properties:{id:{type:"string"}},required:["id"],title:"Identifier with additional properties"}}},g={submit:{alias:[],info:{name:"Submit",description:"Submit entire list"},schema:{}},replace:{alias:[],info:{name:"Replace",description:"Replace data"},schema:{}},push:{alias:[],info:{name:"Push",description:"Adds data at the end to component"},schema:{}},push_front:{alias:[],info:{name:"Push front",description:"Adds data to the front of the component"},schema:{}},delete:{alias:[],info:{name:"Delete data instance",description:"Removes data from the component"},schema:e(e({},f),{},{$id:"v1/listbase/delete"})},pop:{alias:[],info:{name:"Pop back item",description:"Deletes / removes back data item"},schema:{}},pop_front:{alias:[],info:{name:"Pop front item",description:"Deletes / removes front data item"},schema:{}},select:{alias:[],info:{name:"Select item",description:"Selects the data item"},schema:e(e({},f),{},{$id:"v1/listbase/select"})},clear:{alias:[],info:{name:"Clear items",description:"Removes all items from list"},schema:{}}},v={changed:{alias:[],info:{name:"changed",description:"Changed size"},schema:{}},replacing:{alias:[],info:{name:"replacing",description:"Replacing content"},schema:{}},replaced:{alias:[],info:{name:"replaced",description:"Replace content"},schema:{}},submitted:{alias:[],info:{name:"Submitted",description:"Subbited all items in list"},schema:{}},deleted:{alias:[],info:{name:"Deleted",description:"Deleted specified items"},schema:{}},pushing:{alias:[],info:{name:"Pusing",description:"Pushing item in front of list"},schema:{}},pushed:{alias:[],info:{name:"Pushed",description:"Pushed item in front of list"},schema:{}},selected:{alias:[],info:{name:"Selected",description:"Selecting item"},schema:e(e({},f),{},{$id:"v1/listbase/selected"})},deselected:{alias:[],info:{name:"De-Selected",description:"Unselecting item"},schema:{}},clearing:{alias:[],info:{name:"Clearing",description:"Removing all items"},schema:{}},cleared:{alias:[],info:{name:"Cleared",description:"Removed all items"},schema:{}}},I=function(l){t(f,l);var p=a(f);function f(t){var a;d(this,f),a=p.call(this,t),s(i(a),"findItemIndexById",(function(e,t){return u(e,t)})),s(i(a),"updateItem",(function(t,n){var d=a.findItemIndexById(t,a.state.data),s=r(a.state.data);if(d>=0){for(var i=0,o=Object.entries(n);i<o.length;i++){var l=c(o[i],2),p=l[0],u=l[1];s[d][p]=u}a.setState(e(e({},a.state),{},{data:s}))}})),s(i(a),"registerComponent",(function(t,n,d){t=t||{},n=n||{};var s={submit:{schema:{},handler:function(e){a.eventManager.addEvent(a.props.id,"submitted",{count:a.state.data.length,items:a.state.data},{})}},replace:{schema:{},handler:function(t){var n=a.state.data||[];Array.isArray(t)||(t=[t]),a.eventManager.addEvent(a.props.id,"replacing",{count:n.length,old:n,new:t},{});var d=t;a.updateView("replace",[],[],d)&&a.setState(e(e({},a.state),{},{data:d})),a.eventManager.addEvent(a.props.id,"replaced",{count:d.length,items:d},{}),a.eventManager.addEvent(a.props.id,"changed",{count:d.length,items:d},{})}},push:{schema:{},handler:function(t){var n=[],d=[],s=a.state.data||[],i={};Array.isArray(t)||(t=[t]),t.forEach((function(e){var t=a.findItemIndexById(e.id,s);null===t?n.push(e):(s[t]=h(s[t],e),d.push(t)),e.selected&&(i={selectedId:e.id,selectedIndex:t})}));var c=[].concat(r(s),n);try{a.eventManager.addEvent(a.props.id,"pushing",n,{}),a.updateView("push",n,d,c)&&a.setState(e(e(e({},a.state),i),{},{data:c}))}catch(e){a.exceptionCatched("push",e)}a.eventManager.addEvent(a.props.id,"pushed",{count:c.length,items:c,added:n},{}),a.ddEvent=a.eventManager.addEvent(a.props.id,"changed",{count:c.length,items:c,added:n,updated:d},{})}},push_front:{schema:{},handler:function(t){var n=[],d=[],s=a.state.data||[],i={};Array.isArray(t)||(t=[t]),t.forEach((function(e){var t=a.findItemIndexById(e.id,a.state.data);null===t?n.push(e):(s[t]=e,d.push(t)),e.selected&&(i={selectedId:e.id,selectedIndex:t||n.length-1})}));var c=[].concat(n,r(s));a.updateView("push_front",[],d,c)&&a.setState(e(e(e({},a.state),i),{},{data:c})),a.ddEvent=a.eventManager.addEvent(a.props.id,"changed",{count:c.length,items:c},{})}},delete:{schema:{},handler:function(t){Array.isArray(t)||(t=[t]);var n=a.state.data,d=[],s=[];t.forEach((function(e){if(e.id){var t=a.findItemIndexById(e.id,n);null!==t&&(s.push(e.id),n=m(t,n),d.push(t))}}));try{a.updateView("delete",[],d,n)&&a.setState(e(e({},a.state),{},{data:n}))}catch(e){a.exceptionCatched("delete",e)}a.ddEvent=a.eventManager.addEvent(a.props.id,"changed",{count:n.length,items:n,deleted:s},{}),a.ddEvent=a.eventManager.addEvent(a.props.id,"deleted",{count:s.length,items:n,deleted:s},{})}},pop:{schema:{},handler:function(t){if(a.state.data.length>0){var n=a.state.data.slice(),d=n.splice(n.length-1,1);a.updateView("pop",[],d,n)&&(a.setState(e(e({},a.state),{},{data:n})),a.ddEvent=a.eventManager.addEvent(a.props.id,"changed",{count:a.state.data.length,items:a.state.data},{}))}}},pop_front:{schema:{},handler:function(t){if(a.state.data.length>0){var n=a.state.data.slice(),d=n.splice(0,1);a.updateView("pop_front",[],d,n)&&(a.setState(e(e({},a.state),{},{data:n})),a.ddEvent=a.eventManager.addEvent(a.props.id,"changed",{count:a.state.data.length,items:a.state.data},{}))}}},select:{schema:{},handler:function(t){var n=[],d=[];Array.isArray(t)||(t=[t]);for(var s=0;s<a.state.data.length;s++)a.state.data[s].selected=!1;t.forEach((function(e){if(e.id){var t=a.findItemIndexById(e.id,a.state.data);null!==t&&(a.state.data[t].selected=!a.state.data[t].selected,a.state.selectedId=a.state.data[t].id,a.state.selectedIndex=t,n.push(t),d.push(a.state.data[t]))}})),a.setState(e(e({},a.state),{},{data:a.state.data})),a.ddEvent=a.eventManager.addEvent(a.props.id,"selecting",t,null),a.updateView("select",t,n,a.state)&&(a.ddEvent=a.eventManager.addEvent(a.props.id,"selected",d,null))}},clear:{schema:{},handler:function(t){a.ddEvent=a.eventManager.addEvent(a.props.id,"clearing",{count:a.state.data.length,items:a.state.data},{}),a.setState(e(e({},a.state),{},{data:[]})),a.ddEvent=a.eventManager.addEvent(a.props.id,"cleared",{count:a.state.data.length,items:a.state.data},{}),a.ddEvent=a.eventManager.addEvent(a.props.id,"changed",{count:a.state.data.length,items:a.state.data},{}),a.updateView("clear",[],[],[])}}};return a.ddEvent=a.eventManager.register(a.props.id,e(e({},s),t),e(e({},v),n),d),a.ddEvent})),a.props=t;var n=[];if(t.data&&(Array.isArray(t.data)?n=t.data:"object"===o(t.data)?t.data.length&&(n=[t.data]):n=[t.data]),a.state={data:n||[],selectedIndex:0,selectedId:null},!a.props.manager)throw new Error("Manager was not passed through StateList props");return a.eventManager=a.props.manager.getEventManager(),a}return n(f)}(l.StateInstance),E=function(r){t(o,r);var c=a(o);function o(t){var a;return d(this,o),t.config.options||(t.config.options={}),a=c.call(this,t),s(i(a),"updateView",(function(e,t,a,n){return!0})),s(i(a),"exceptionCatched",(function(e,t){})),s(i(a),"findItemIndexById",(function(e,t){if(a.stateManager)return a.stateManager.findItemIndexById(e,t)})),s(i(a),"updateItem",(function(t,n,d){return d?a.updateItemSilent(t,n):a.triggerAction("push",e(e({},n),{},{id:t}))})),s(i(a),"updateItemSilent",(function(e,t){if(a.stateManager)return a.stateManager.updateItem(e,t)})),s(i(a),"getData",(function(){return a.state.data})),s(i(a),"showSelectedRow",(function(e){return!!a.props.config.options.select&&e.selected})),s(i(a),"showSelected",(function(e,t){return!0})),s(i(a),"setSelectedId",(function(e,t,n){a.triggerAction("select",{id:e})})),s(i(a),"getSelectedId",(function(){var e=[];return a.state.data.forEach((function(t){t.selected&&e.push(t.id)})),e})),s(i(a),"getItemTreeState",(function(){var e=[],t=[];return a.state.data.forEach((function(a){a.selected&&e.push(a.id),a.expanded&&t.push(a.id)})),{selected:e,expanded:t,focused:a.state.selectedId}})),s(i(a),"handleSelect",(function(e,t,n,d){d||a.setSelectedId(t.id,d)})),a.props=t,a}return n(o,[{key:"render",value:function(){return null}}]),o}(p.StateBaseComponent),S={events:v,triggers:g,StateList:I,ListBase:E};export{E as ListBase,I as StateList,S as default,v as events,g as triggers};
//# sourceMappingURL=ListBase.js.map
